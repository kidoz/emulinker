<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!--
        CT_CONSTRUCTOR_THROW: Constructor throws exception

        These are intentional for protocol message classes where constructor
        validation ensures only valid objects are created. Throwing from
        constructor is the correct behavior for invalid input.
    -->

    <!-- Protocol message classes - validation in constructor is intentional -->
    <Match>
        <Package name="su.kidoz.kaillera.controller.v086.protocol"/>
        <Bug pattern="CT_CONSTRUCTOR_THROW"/>
    </Match>

    <!-- Access manager inner classes - parsing validation is intentional -->
    <Match>
        <Class name="~su\.kidoz\.kaillera\.access\.FileBasedAccessManager\$.*"/>
        <Bug pattern="CT_CONSTRUCTOR_THROW"/>
    </Match>

    <!-- FileBasedAccessManager - file I/O exceptions are expected -->
    <Match>
        <Class name="su.kidoz.kaillera.access.FileBasedAccessManager"/>
        <Bug pattern="CT_CONSTRUCTOR_THROW"/>
    </Match>

    <!-- Network classes - socket exceptions are expected -->
    <Match>
        <Class name="~su\.kidoz\.net\..*"/>
        <Bug pattern="CT_CONSTRUCTOR_THROW"/>
    </Match>

    <!-- Controller classes - initialization exceptions are expected -->
    <Match>
        <Class name="su.kidoz.kaillera.controller.connectcontroller.ConnectController"/>
        <Bug pattern="CT_CONSTRUCTOR_THROW"/>
    </Match>

    <!--
        DE_MIGHT_IGNORE: Empty catch blocks for InterruptedException

        These are intentional for thread sleep/wait patterns where the
        exception is expected and the code should simply continue.
    -->
    <Match>
        <Bug pattern="DE_MIGHT_IGNORE"/>
    </Match>

    <!--
        ENV_USE_PROPERTY_INSTEAD_OF_ENV: Using System.getenv instead of System.getProperty

        Legacy code pattern - not critical to fix.
    -->
    <Match>
        <Bug pattern="ENV_USE_PROPERTY_INSTEAD_OF_ENV"/>
    </Match>

    <!--
        HE_EQUALS_USE_HASHCODE: equals() without hashCode()

        These exception/model classes are not used in collections.
    -->
    <Match>
        <Class name="su.kidoz.kaillera.model.impl.PlayerTimeoutException"/>
        <Bug pattern="HE_EQUALS_USE_HASHCODE"/>
    </Match>
    <Match>
        <Class name="su.kidoz.kaillera.model.impl.KailleraUserImpl"/>
        <Bug pattern="HE_EQUALS_USE_HASHCODE"/>
    </Match>

    <!--
        Test source exclusions - these are acceptable patterns in test code
    -->
    <Match>
        <Source name="~.*Test\.java"/>
        <Bug pattern="RV_RETURN_VALUE_IGNORED_BAD_PRACTICE,DLS_DEAD_LOCAL_STORE,RV_RETURN_VALUE_IGNORED_NO_SIDE_EFFECT,RV_RETURN_VALUE_IGNORED,BC_VACUOUS_INSTANCEOF,REC_CATCH_EXCEPTION"/>
    </Match>

    <!--
        EI_EXPOSE_REP / EI_EXPOSE_REP2: May expose internal representation

        These are common in configuration, DTO, event, and model classes where
        returning the actual object reference is intentional. The codebase uses
        internal objects that are safe to share within the application.
    -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2"/>
    </Match>

    <!--
        AT_*: Threading warnings for shared primitive variables

        These are in speed measurement and auto-fire detection code where
        perfect accuracy is not critical. Most are legacy patterns.
        TODO: Consider using AtomicLong/volatile for these fields in a future refactor.
    -->
    <Match>
        <Bug pattern="AT_NONATOMIC_64BIT_PRIMITIVE,AT_NONATOMIC_OPERATIONS_ON_SHARED_VARIABLE,AT_STALE_THREAD_WRITE_OF_PRIMITIVE"/>
    </Match>

    <!--
        IS2_INCONSISTENT_SYNC: Inconsistent synchronization of shared fields

        Legacy code patterns where fields are accessed both with and without locks.
        TODO: Audit synchronization patterns in AutoFireScanner and similar classes.
    -->
    <Match>
        <Bug pattern="IS2_INCONSISTENT_SYNC"/>
    </Match>

    <!--
        VO_VOLATILE_INCREMENT: Non-atomic increment of volatile field

        Incrementing volatile fields is not atomic. For counters like
        droppedEventsCount, exact accuracy is not required.
    -->
    <Match>
        <Bug pattern="VO_VOLATILE_INCREMENT"/>
    </Match>

    <!--
        SS_SHOULD_BE_STATIC: Unread instance field that could be static

        Release info fields may be used reflectively or for future features.
    -->
    <Match>
        <Bug pattern="SS_SHOULD_BE_STATIC"/>
    </Match>

    <!--
        URF_UNREAD_FIELD / UuF_UNUSED_FIELD: Unread or unused fields

        Some fields are reserved for future use or intentionally unused.
    -->
    <Match>
        <Bug pattern="URF_UNREAD_FIELD,UUF_UNUSED_FIELD"/>
    </Match>

    <!--
        Dodgy code patterns - informational style issues
    -->
    <Match>
        <Bug pattern="SF_SWITCH_NO_DEFAULT,RV_RETURN_VALUE_IGNORED_NO_SIDE_EFFECT"/>
    </Match>

    <!--
        Legacy code patterns - pre-existing issues to address incrementally
    -->
    <Match>
        <Bug pattern="DM_DEFAULT_ENCODING"/>
    </Match>
    <Match>
        <Bug pattern="DM_BOXED_PRIMITIVE_FOR_PARSING"/>
    </Match>
    <Match>
        <Bug pattern="DM_BOXED_PRIMITIVE_FOR_COMPARE"/>
    </Match>
    <Match>
        <Bug pattern="IL_INFINITE_RECURSIVE_LOOP"/>
    </Match>
    <Match>
        <Bug pattern="MS_MUTABLE_ARRAY"/>
    </Match>
    <Match>
        <Bug pattern="MS_SHOULD_BE_FINAL"/>
    </Match>
    <Match>
        <Bug pattern="MS_SHOULD_BE_REFACTORED_TO_BE_FINAL"/>
    </Match>
    <Match>
        <Bug pattern="STCAL_INVOKE_ON_STATIC_DATE_FORMAT_INSTANCE"/>
    </Match>
    <Match>
        <Bug pattern="STCAL_STATIC_SIMPLE_DATE_FORMAT_INSTANCE"/>
    </Match>
</FindBugsFilter>
